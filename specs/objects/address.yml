name: 'Address'
locations:
  'shared':
    description: 'Located in shared.'
    device: ['panorama', 'ngfw']
    xpath: ['config', 'shared']
  'from_panorama':
    description: 'Located in the config pushed from Panorama.'
    # NOTE: "read_only" would put something in the docstring, but otherwise wouldn't restrict functionality.
    read_only: true
    device: ['ngfw']
    xpath: ['config', 'panorama']
  'vsys':
    description: 'Located in a specific vsys.'
    device: ['ngfw']
    xpath:
      - 'config'
      - 'devices'
      - '{{ Entry $ngfw_device }}'
      - 'vsys'
      - '{{ Entry $vsys }}'
    vars:
      'ngfw_device':
        description: 'The NGFW device.'
        default: 'localhost.localdomain'
      'vsys':
        description: 'The vsys.'
        default: 'vsys1'
        validation:
          not_values:
            'shared': 'The vsys cannot be "shared". Use the "shared" path instead.'
  'device_group':
    description: 'Located in a specific device group.'
    device: ['panorama']
    xpath:
      - 'config'
      - 'devices'
      - '{{ Entry $panorama_device }}'
      - 'device-group'
      - '{{ Entry $device_group }}'
    vars:
      'panorama_device':
        description: 'The panorama device.'
        default: 'localhost.localdomain'
      'device_group':
        description: 'The device group.'
        required: true
        validation:
          not_values:
            'shared': 'The device group cannot be "shared". Use the "shared" path instead.'
spec:
  name: 'The name of the address object.'
  version: '10.1.0'
  properties:
    params:
      description:
        description: 'The description.'
        type: 'string'
        length:
          min: 0
          max: 1023
        profiles:
          -
            xpath: ["description"]
        tags:
          description: 'The administrative tags.'
          type: 'list'
          count:
            max: 64
          items:
            type: 'string'
            length:
              max: 127
          profiles:
            -
              type: 'member'
              xpath: ["tag"]
      one_of:
        'ip_netmask':
          description: 'The IP netmask value.'
          profiles:
            -
              xpath: ["ip-netmask"]
        'ip_range':
          description: 'The IP range value.'
          profiles:
            -
              xpath: ["ip-range"]
        'fqdn':
          description: 'The FQDN value.'
          regex: '^[a-zA-Z0-9_]([a-zA-Z0-9:_-])+[a-zA-Z0-9]$'
          length:
            min: 1
            max: 255
          profiles:
            -
              xpath: ["fqdn"]
        'ip_wildcard':
          description: 'The IP wildcard value.'
          profiles:
            -
              xpath: ["ip-wildcard"]
