name: 'NTP'
terraform_provider_suffix: 'ntp'
locations:
  'system':
    description: 'Located in a system settings.'
    device:
      panorama: true
      ngfw: true
    xpath:
      - 'config'
      - 'devices'
      - '{{ Entry $ngfw_device }}'
      - 'deviceconfig'
      - 'system'
    vars:
      'ngfw_device':
        description: 'The NGFW device.'
        default: 'localhost.localdomain'
  'template':
    description: 'Located in a specific template.'
    device:
      panorama: true
    xpath:
      - 'config'
      - 'devices'
      - '{{ Entry $panorama_device }}'
      - 'template'
      - '{{ Entry $template }}'
      - 'config'
      - 'devices'
      - '{{ Entry $ngfw_device }}'
      - 'deviceconfig'
      - 'system'
    vars:
      'panorama_device':
        description: 'The panorama device.'
        default: 'localhost.localdomain'
      'template':
        description: 'The template.'
        required: true
      'ngfw_device':
        description: 'The NGFW device.'
        default: 'localhost.localdomain'
spec:
  version: '10.1.0'
  properties:
    params:
      ntp_servers:
        description: 'NTP servers'
        profiles:
          -
            xpath: ["ntp-servers"]
        spec:
          properties:
            params:
              primary_ntp_server:
                description: 'Primary NTP Server Information'
                profiles:
                  -
                    xpath: ["primary-ntp-server"]
                spec:
                  properties:
                    params:
                      ntp_server_address:
                        description: 'NTP Server IP Address or Domain Name'
                        profiles:
                          -
                            xpath: ["ntp-server-address"]
                      authentication_type:
                        description: 'NTP Authentication'
                        profiles:
                          -
                            xpath: ["authentication-type"]
                        spec:
                          properties:
                            one_of:
                              none:
                                description: 'No NTP Authentication'
                                profiles:
                                  -
                                    xpath: ["none"]
                              symmetric_key:
                                description: 'Symmetric Key Authentication'
                                profiles:
                                  -
                                    xpath: ["symmetric-key"]
                                spec:
                                  properties:
                                    params:
                                      key_id:
                                        description: 'Symmetric Key Number'
                                        type: 'int'
                                        value:
                                          min: 1
                                          max: 65534
                                        profiles:
                                          -
                                            xpath: ["key-id"]
                                    one_of:
                                      md5:
                                        profiles:
                                          -
                                            xpath: ["algorithm", "md5"]
                                        spec:
                                          properties:
                                            params:
                                              authentication_key:
                                                description: 'Symmetric Key MD5 String'
                                                length:
                                                  min: 6
                                                  max: 32
                                                profiles:
                                                  -
                                                    xpath: ["authentication-key"]
                                      sha1:
                                        profiles:
                                          -
                                            xpath: ["algorithm", "sha1"]
                                        spec:
                                          properties:
                                            params:
                                              authentication_key:
                                                description: 'Symmetric Key SHA1 Hexadecimal'
                                                length:
                                                  min: 40
                                                  max: 40
                                                profiles:
                                                  -
                                                    xpath: ["authentication-key"]
                              autokey:
                                description: 'Autokey Authentication'
                                profiles:
                                  -
                                    xpath: ["autokey"]
              secondary_ntp_server:
                description: 'Secondary NTP Server Information'
                profiles:
                  -
                    xpath: ["secondary-ntp-server"]
                spec:
                  properties:
                    params:
                      ntp_server_address:
                        description: 'NTP Server IP Address or Domain Name'
                        profiles:
                          -
                            xpath: ["ntp-server-address"]
                      authentication_type:
                        description: 'NTP Authentication'
                        profiles:
                          -
                            xpath: ["authentication-type"]
                        spec:
                          properties:
                            one_of:
                              none:
                                description: 'No NTP Authentication'
                                profiles:
                                  -
                                    xpath: ["none"]
                              symmetric_key:
                                description: 'Symmetric Key Authentication'
                                profiles:
                                  -
                                    xpath: ["symmetric-key"]
                                spec:
                                  properties:
                                    params:
                                      key_id:
                                        description: 'Symmetric Key Number'
                                        type: 'int'
                                        value:
                                          min: 1
                                          max: 65534
                                        profiles:
                                          -
                                            xpath: ["key-id"]
                                    one_of:
                                      md5:
                                        profiles:
                                          -
                                            xpath: ["algorithm/md5"]
                                        spec:
                                          properties:
                                            params:
                                              authentication_key:
                                                description: 'Symmetric Key MD5 String'
                                                length:
                                                  min: 6
                                                  max: 32
                                                profiles:
                                                  -
                                                    xpath: ["authentication-key"]
                                      sha1:
                                        profiles:
                                          -
                                            xpath: ["algorithm/sha1"]
                                        spec:
                                          properties:
                                            params:
                                              authentication_key:
                                                description: 'Symmetric Key SHA1 Hexadecimal'
                                                length:
                                                  min: 40
                                                  max: 40
                                                profiles:
                                                  -
                                                    xpath: ["authentication-key"]
                              autokey:
                                description: 'Autokey Authentication'
                                profiles:
                                  -
                                    xpath: ["autokey"]
